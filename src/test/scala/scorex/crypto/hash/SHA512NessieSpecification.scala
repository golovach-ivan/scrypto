package scorex.crypto.hash

import org.scalatest.{Matchers, PropSpec}
import scorex.utils.BytesHex.hex2bytes

/**
 * Test vectors from
 * [[https://www.cosic.esat.kuleuven.be/nessie/testvectors/hash/sha/Sha-2-512.unverified.test-vectors Project NESSIE - New European Schemes for Signature, Integrity, and Encryption]]
 */
class SHA512NessieSpecification extends PropSpec
with Matchers {

  property("Set 1, vector# 0") {
    Sha512("") shouldBe hex2bytes("" +
      "CF83E1357EEFB8BDF1542850D66D8007" +
      "D620E4050B5715DC83F4A921D36CE9CE" +
      "47D0D13C5D85F2B0FF8318D2877EEC2F" +
      "63B931BD47417A81A538327AF927DA3E")
  }

  property("Set 1, vector# 1") {
    Sha512("a") shouldBe hex2bytes("" +
      "1F40FC92DA241694750979EE6CF582F2" +
      "D5D7D28E18335DE05ABC54D0560E0F53" +
      "02860C652BF08D560252AA5E74210546" +
      "F369FBBBCE8C12CFC7957B2652FE9A75")
  }

  property("Set 1, vector# 2") {
    Sha512("abc") shouldBe hex2bytes("" +
      "DDAF35A193617ABACC417349AE204131" +
      "12E6FA4E89A97EA20A9EEEE64B55D39A" +
      "2192992A274FC1A836BA3C23A3FEEBBD" +
      "454D4423643CE80E2A9AC94FA54CA49F")
  }

  property("Set 1, vector# 3") {
    Sha512("message digest") shouldBe hex2bytes("" +
      "107DBF389D9E9F71A3A95F6C055B9251" +
      "BC5268C2BE16D6C13492EA45B0199F33" +
      "09E16455AB1E96118E8A905D5597B720" +
      "38DDB372A89826046DE66687BB420E7C")
  }

  property("Set 1, vector# 4") {
    Sha512("abcdefghijklmnopqrstuvwxyz") shouldBe hex2bytes("" +
      "4DBFF86CC2CA1BAE1E16468A05CB9881" +
      "C97F1753BCE3619034898FAA1AABE429" +
      "955A1BF8EC483D7421FE3C1646613A59" +
      "ED5441FB0F321389F77F48A879C7B1F1")
  }

  property("Set 1, vector# 5") {
    Sha512("abcdbcdecdefdefgefghfghighijhijkijkljklmklmnlmnomnopnopq") shouldBe hex2bytes("" +
      "204A8FC6DDA82F0A0CED7BEB8E08A416" +
      "57C16EF468B228A8279BE331A703C335" +
      "96FD15C13B1B07F9AA1D3BEA57789CA0" +
      "31AD85C7A71DD70354EC631238CA3445")
  }

  property("Set 1, vector# 6") {
    Sha512("" +
      "ABCDEFGHIJKLMNOPQRSTUVWXYZ" +
      "abcdefghijklmnopqrstuvwxyz" +
      "0123456789") shouldBe hex2bytes("" +
      "1E07BE23C26A86EA37EA810C8EC78093" +
      "52515A970E9253C26F536CFC7A9996C4" +
      "5C8370583E0A78FA4A90041D71A4CEAB" +
      "7423F19C71B9D5A3E01249F0BEBD5894")
  }

  property("Set 1, vector# 7") {
    Sha512("" +
      "1234567890" +
      "1234567890" +
      "1234567890" +
      "1234567890" +
      "1234567890" +
      "1234567890" +
      "1234567890" +
      "1234567890") shouldBe hex2bytes("" +
      "72EC1EF1124A45B047E8B7C75A932195" +
      "135BB61DE24EC0D1914042246E0AEC3A" +
      "2354E093D76F3048B456764346900CB1" +
      "30D2A4FD5DD16ABB5E30BCB850DEE843")
  }

  property("Set 2, vector# 8") {
    Sha512("\u0000") shouldBe hex2bytes("" +
      "B8244D028981D693AF7B456AF8EFA4CA" +
      "D63D282E19FF14942C246E50D9351D22" +
      "704A802A71C3580B6370DE4CEB293C32" +
      "4A8423342557D4E5C38438F0E36910EE")
  }

  property("Set 2, vector# 16") {
    Sha512("\u0000\u0000") shouldBe hex2bytes("" +
      "5EA71DC6D0B4F57BF39AADD07C208C35" +
      "F06CD2BAC5FDE210397F70DE11D439C6" +
      "2EC1CDF3183758865FD387FCEA0BADA2" +
      "F6C37A4A17851DD1D78FEFE6F204EE54")
  }

  property("Set 2, vector# 24") {
    Sha512("\u0000\u0000\u0000") shouldBe hex2bytes("" +
      "6D518F8B31D1882FEACE10A9215F5D8C" +
      "F5AFE037652A1D11D9C1408D988C2A4F" +
      "71A5EDFC85D0712FA3F4E21B2C0A244C" +
      "8C0D333BAB454311E24067D2A83E5E59")
  }

  property("Set 2, vector# 32") {
    Sha512("\u0000\u0000\u0000\u0000") shouldBe hex2bytes("" +
      "EC2D57691D9B2D40182AC565032054B7" +
      "D784BA96B18BCB5BE0BB4E70E3FB041E" +
      "FF582C8AF66EE50256539F2181D7F9E5" +
      "3627C0189DA7E75A4D5EF10EA93B20B3")
  }

  property("Set 2, vector# 40") {
    Sha512("\u0000\u0000\u0000\u0000\u0000") shouldBe hex2bytes("" +
      "65FAA9D920E0E9CFF43FC3F30AB02BA2" +
      "E8CF6F4643B58F7C1E64583FBEC8A268" +
      "E677B0EC4D54406E748BECB53FDA210F" +
      "5D4F39CF2A5014B1CA496B0805182649")
  }

  property("Set 2, vector# 48") {
    Sha512("\u0000\u0000\u0000\u0000\u0000\u0000") shouldBe hex2bytes("" +
      "C11D53B386F5EE0C042C9246D4A38B1E" +
      "032A3BC9EA3F6827A9482D4F31B6E4A1" +
      "973C97190BDC59D961D5B6F1D5B06C25" +
      "C4B9E94CA04EAEF395A928FA851493D6")
  }

  property("Set 2, vector# 56") {
    Sha512("\u0000\u0000\u0000\u0000\u0000\u0000\u0000") shouldBe hex2bytes("" +
      "76AFCA18A9B81FFB967FFCF0460ED221" +
      "C3605D3820057214D785FA88259BB5CB" +
      "729576178E6EDB0134F645D2E2E92CBA" +
      "BF1333462F3B9058692C950F51C64A92")
  }

  property("Set 2, vector# 64") {
    Sha512("\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000") shouldBe hex2bytes("" +
      "1B7409CCF0D5A34D3A77EAABFA9FE274" +
      "27655BE9297127EE9522AA1BF4046D4F" +
      "945983678169CB1A7348EDCAC47EF0D9" +
      "E2C924130E5BCC5F0D94937852C42F1B")
  }

  property("Set 2, vector# 72") {
    Sha512("\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000") shouldBe hex2bytes("" +
      "A85DE39409374651002C84CBA7C928EB" +
      "96FB82F88ACC2AEAC392985DEF3E1389" +
      "346122B82C9C47B743A5C2764BB0E3F5" +
      "C309AF7202DBE723E69A5193E84FCBC4")
  }

  property("Set 2, vector# 80") {
    Sha512("\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000") shouldBe hex2bytes("" +
      "19BD3CBB62B1937957A11CABD0D39860" +
      "582B6928E77D0E0EA5EE7F3B2F8CACB3" +
      "DEA8EA0972651ADC3245FD10926F2F31" +
      "E80377196E4E6C7EE2BD74051E58BCBA")
  }

  property("Set 2, vector# 88") {
    Sha512("\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000") shouldBe hex2bytes("" +
      "84BCD394CF4D2F2D59A04391726FE7CC" +
      "0438664E13907418D69FDCCB0297ED79" +
      "FA0C6BA2046CDD8F07E13D9C40D5C783" +
      "F051260DE5FD2902890817E6F74D03FB")
  }

  property("Set 2, vector# 96") {
    Sha512("\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000") shouldBe hex2bytes("" +
      "666A9A1A7542E895A9F447D1C3E0FFD6" +
      "79BBF6346E0C43F5C7A733C46F5E56C2" +
      "F65E69DFD4769A9CAD2B79B31D282F1C" +
      "A2AA296EF41BD9833947ADA194F46940")
  }

  property("Set 2, vector# 104") {
    Sha512("\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000") shouldBe hex2bytes("" +
      "B4286A45FED95442F6BDC6CA03D29687" +
      "AED2D25F9AF548F099D05DCDDCCE2911" +
      "82BB900D2519B36A0B708A027204708E" +
      "3959320A4AA3F4E79C6D94C6932018EB")
  }

  property("Set 2, vector# 112") {
    Sha512("\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000") shouldBe hex2bytes("" +
      "7CF95CDE6D8D85F13497DDBABC60A56B" +
      "CA0ABEABD2BC3E723C0A4A8C0784B14C" +
      "4EE3317620B79D260D42608C8B907571" +
      "499187078D14304A5E7A84BC55193CE9")
  }

  property("Set 2, vector# 120") {
    Sha512("\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000\u0000") shouldBe hex2bytes("" +
      "DA7852FB298E7456612A129EC356BFB6" +
      "329720E795BE483F5F07ADAA146EAEC0" +
      "DB2907902C087456F5F8C85B05995665" +
      "380CC7E25CEFE1663F6D7158D1191419")
  }
}
